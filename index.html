<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Polo Fashions - Digital Bill</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- React and ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- HTML2Canvas for image generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <!-- Custom CSS -->


</head>

<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useRef } = React;

        // Simple icon components
        const Download = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3" />
            </svg>
        );

        const Share2 = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <circle cx="18" cy="5" r="3" /><circle cx="6" cy="12" r="3" /><circle cx="18" cy="19" r="3" />
                <line x1="8.59" y1="13.51" x2="15.42" y2="17.49" /><line x1="15.41" y1="6.51" x2="8.59" y2="10.49" />
            </svg>
        );

        const Plus = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <line x1="12" y1="5" x2="12" y2="19" /><line x1="5" y1="12" x2="19" y2="12" />
            </svg>
        );

        const Trash2 = ({ size = 24 }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polyline points="3 6 5 6 21 6" /><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" />
                <line x1="10" y1="11" x2="10" y2="17" /><line x1="14" y1="11" x2="14" y2="17" />
            </svg>
        );

        function PoloFashionsBill() {
            const [cardNumber, setCardNumber] = useState('');
            const [phoneNumber, setPhoneNumber] = useState('');
            const [date, setDate] = useState(new Date().toISOString().split('T')[0]);
            const [items, setItems] = useState([{ shirts: '', pants: '', amount: '' }]);
            const [advance, setAdvance] = useState('');
            const billRef = useRef(null);

            const addItem = () => {
                setItems([...items, { shirts: '', pants: '', amount: '' }]);
            };

            const removeItem = (index) => {
                if (items.length > 1) {
                    setItems(items.filter((_, i) => i !== index));
                }
            };

            const updateItem = (index, field, value) => {
                const newItems = [...items];
                newItems[index][field] = value;
                setItems(newItems);
            };

            const calculateTotal = () => {
                return items.reduce((sum, item) => sum + (parseFloat(item.amount) || 0), 0);
            };

            const calculateBalance = () => {
                const total = calculateTotal();
                const adv = parseFloat(advance) || 0;
                return total - adv;
            };

            const downloadBill = async () => {
                const element = billRef.current;
                const canvas = await html2canvas(element, {
                    scale: 2,
                    backgroundColor: '#ffffff',
                    logging: false
                });

                canvas.toBlob((blob) => {
                    const url = URL.createObjectURL(blob);
                    const link = document.createElement('a');
                    link.href = url;
                    link.download = `Bill_${cardNumber || 'new'}_${date}.png`;
                    link.click();
                    URL.revokeObjectURL(url);
                });
            };

            // ---- REPLACED shareBill (only change) ----
            const shareBill = async () => {
                if (!phoneNumber || phoneNumber.length < 10) {
                    alert('10 ಅಂಕಿಯ ಫೋನ್ ಸಂಖ್ಯೆಯನ್ನು ನಮೂದಿಸಿ\nPlease enter customer phone number (10 digits)');
                    return;
                }

                // 1) Download the bill image so user can attach it manually in WhatsApp
                await downloadBill();

                // 2) Format phone number to international (assumes India if 10 digits)
                let formattedPhone = phoneNumber.replace(/\D/g, '');
                if (formattedPhone.length === 10) {
                    formattedPhone = '91' + formattedPhone;
                }

                // 3) Prepare prefilled message
                const message = `Hi! Your bill from Polo Fashions is ready.\n\nCard No: ${cardNumber}\nDate: ${date}\nTotal: ₹${calculateTotal()}\nAdvance: ₹${advance || 0}\nBalance: ₹${calculateBalance()}\n\n🧾 Your digital Card is generated. Please check it once.`;

                // 4) Open WhatsApp chat (mobile or web) with prefilled text
                const whatsappUrl = `https://wa.me/${formattedPhone}?text=${encodeURIComponent(message)}`;
                window.open(whatsappUrl, '_blank');
            };
            // --------------------------------------------

            const clearForm = () => {
                setCardNumber('');
                setPhoneNumber('');
                setDate(new Date().toISOString().split('T')[0]);
                setItems([{ shirts: '', pants: '', amount: '' }]);
                setAdvance('');
            };

            return (
                <div className="app-container">
                    <div className="card">
                        <h1 className="text-3xl font-bold text-center mb-8 text-blue-900">
                            👔  Polo Fashions - Digital Bill
                        </h1>

                        <div className="space-y-6 mb-8">
                            {/* Card Number */}
                            <div className="bg-blue-50 p-6 rounded-xl border-4 border-blue-500">
                                <label className="block text-2xl font-bold mb-3 text-blue-900">
                                    📋 Card Number
                                </label>
                                <input
                                    type="text"
                                    value={cardNumber}
                                    onChange={(e) => setCardNumber(e.target.value)}
                                    className="w-full text-4xl font-bold p-4 border-4 border-blue-600 rounded-lg text-center"
                                    placeholder="123"
                                />
                            </div>

                            {/* Phone Number */}
                            <div className="bg-green-50 p-6 rounded-xl border-4 border-green-500">
                                <label className="block text-2xl font-bold mb-3 text-green-900">
                                    📞 Customer Phone Number
                                </label>
                                <input
                                    type="tel"
                                    value={phoneNumber}
                                    onChange={(e) => setPhoneNumber(e.target.value)}
                                    className="w-full text-4xl font-bold p-4 border-4 border-green-600 rounded-lg text-center"
                                    placeholder="9876543210"
                                    maxLength="10"
                                />
                            </div>

                            {/* Date */}
                            <div>
                                <label className="block text-xl font-semibold mb-2">📅 Date</label>
                                <input
                                    type="date"
                                    value={date}
                                    onChange={(e) => setDate(e.target.value)}
                                    className="w-full text-xl p-3 border-2 border-gray-300 rounded-lg"
                                />
                            </div>

                            {/* Items */}
                            <div>
                                <div className="flex justify-between items-center mb-4">
                                    <label className="text-xl font-bold">🛍️ Items</label>
                                    <button
                                        onClick={addItem}
                                        className="bg-green-600 text-white px-6 py-3 rounded-lg text-lg hover:bg-green-700 flex items-center gap-2"
                                    >
                                        <Plus size={24} /> Add Item
                                    </button>
                                </div>

                                {items.map((item, index) => (
                                    <div key={index} className="grid grid-cols-4 gap-3 mb-3 bg-gray-50 p-4 rounded-lg">
                                        <input
                                            type="text"
                                            value={item.shirts}
                                            onChange={(e) => updateItem(index, 'shirts', e.target.value)}
                                            className="p-3 border-2 border-gray-300 rounded text-lg"
                                            placeholder="Shirts"
                                        />
                                        <input
                                            type="text"
                                            value={item.pants}
                                            onChange={(e) => updateItem(index, 'pants', e.target.value)}
                                            className="p-3 border-2 border-gray-300 rounded text-lg"
                                            placeholder="Pants"
                                        />
                                        <input
                                            type="number"
                                            value={item.amount}
                                            onChange={(e) => updateItem(index, 'amount', e.target.value)}
                                            className="p-3 border-2 border-gray-300 rounded text-lg font-bold"
                                            placeholder="₹ Amount"
                                        />
                                        <button
                                            onClick={() => removeItem(index)}
                                            className="p-3 bg-red-500 text-white rounded hover:bg-red-600 flex items-center justify-center"
                                            disabled={items.length === 1}
                                        >
                                            <Trash2 size={20} />
                                        </button>
                                    </div>
                                ))}
                            </div>

                            {/* Totals */}
                            <div className="grid grid-cols-3 gap-4">
                                <div className="bg-gray-50 p-4 rounded-lg border-2 border-gray-300">
                                    <label className="block text-lg font-semibold mb-2">Total</label>
                                    <div className="text-3xl font-bold text-gray-800">
                                        ₹{calculateTotal().toFixed(0)}
                                    </div>
                                </div>
                                <div className="bg-blue-50 p-4 rounded-lg border-2 border-blue-400">
                                    <label className="block text-lg font-semibold mb-2">Advance</label>
                                    <input
                                        type="number"
                                        value={advance}
                                        onChange={(e) => setAdvance(e.target.value)}
                                        className="w-full text-2xl font-bold p-2 border-2 border-blue-500 rounded"
                                        placeholder="0"
                                    />
                                </div>
                                <div className="bg-red-50 p-4 rounded-lg border-2 border-red-400">
                                    <label className="block text-lg font-semibold mb-2">Balance</label>
                                    <div className="text-3xl font-bold text-red-600">
                                        ₹{calculateBalance().toFixed(0)}
                                    </div>
                                </div>
                            </div>
                        </div>

                        {/* Buttons */}
                        <div className="grid grid-cols-3 gap-4">
                            <button
                                onClick={downloadBill}
                                className="flex flex-col items-center justify-center gap-2 bg-blue-600 text-white py-4 px-6 rounded-xl text-lg font-bold hover:bg-blue-700"
                            >
                                <Download size={32} />
                                <span>Download</span>
                            </button>
                            <button
                                onClick={shareBill}
                                className="flex flex-col items-center justify-center gap-2 bg-green-600 text-white py-4 px-6 rounded-xl text-lg font-bold hover:bg-green-700"
                            >
                                <Share2 size={32} />
                                <span>Send WhatsApp</span>
                            </button>
                            <button
                                onClick={clearForm}
                                className="flex flex-col items-center justify-center gap-2 bg-gray-600 text-white py-4 px-6 rounded-xl text-lg font-bold hover:bg-gray-700"
                            >
                                <Trash2 size={32} />
                                <span>Clear All</span>
                            </button>
                        </div>
                    </div>

                    {/* Bill Preview */}
                    <div className="bill-preview">
                        <h2 className="text-2xl font-bold text-center mb-6 text-gray-700">
                            👇 Bill Preview 👇
                        </h2>
                        <div ref={billRef} className="bg-white p-8 card-bill">
                            <div className="bill-border mb-4 name-card">
                                <div className="text-center">
                                    <div className="text-sm mb-2">
                                        ✋ We are not responsible for stitched cloths after 3 Months
                                    </div>
                                    <div className="text-4xl font-bold text-blue-900 mb-2">ಪೋಲೋ ಫ್ಯಾಷನ್ಸ್</div>
                                    <div className="text-4xl font-bold my-4 text-blue-900">Card no:
                                        {cardNumber || '___'}
                                    </div>
                                    <div className="text-2xl font-semibold mb-2">Date: {date}</div>
                                </div>
                            </div>

                            <div className="bill-border mb-4 overflow-hidden">
                                <table className="w-full">
                                    <thead className="bg-blue-900 text-white">
                                        <tr>
                                            <th className="p-3 text-left text-lg">Sr.</th>
                                            <th className="p-3 text-center text-lg">SHIRTS</th>
                                            <th className="p-3 text-center text-lg">PANTS</th>
                                            <th className="p-3 text-right text-lg">Amount</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {items.map((item, index) => (
                                            <tr key={index} className="border-b-2 border-blue-900">
                                                <td className="p-3 text-lg">{index + 1}</td>
                                                <td className="p-3 text-center text-lg">{item.shirts}</td>
                                                <td className="p-3 text-center text-lg">{item.pants}</td>
                                                <td className="p-3 text-right text-lg font-semibold">
                                                    {item.amount}
                                                </td>
                                            </tr>
                                        ))}
                                    </tbody>
                                </table>
                            </div>

                            <div className="bill-border">
                                <div className="flex justify-between text-2xl font-bold mb-3">
                                    <span>Total:</span>
                                    <span>₹{calculateTotal().toFixed(0)}</span>
                                </div>
                                <div className="flex justify-between text-2xl font-bold mb-3">
                                    <span>Advance:</span>
                                    <span>₹{advance || '0'}</span>
                                </div>
                                <div className="flex justify-between text-3xl font-bold text-red-600 pt-3 border-t-2 border-blue-900">
                                    <span>Balance:</span>
                                    <span>₹{calculateBalance().toFixed(0)}</span>
                                </div>
                            </div>

                            <div className="mt-6 text-center bill-border address-card">
                                <div className="text-4xl font-bold text-blue-900 mb-2">POLO FASHIONS</div>
                                <div className="text-base">
                                    Get Your Dress Ready in as soon as 1–2 Hours – Only at Polo Fashions!
                                </div>
                                <div className="text-base">#GF-30, Anjuman-Eslamiya Complex,</div>
                                <div className="text-base">T.V.S. Road</div>
                                <div className="text-base">Kollegal-571 440</div>
                                <div className="text-lg font-bold mt-2">Mob: 9742445626</div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        // Render the app
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<PoloFashionsBill />);
    </script>
</body>

</html>